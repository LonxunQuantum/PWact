#Generated by Multiwfn
&GLOBAL
  PROJECT CP2K_MD
  PRINT_LEVEL medium
  RUN_TYPE MD
&END GLOBAL

&FORCE_EVAL
  METHOD Quickstep
  &SUBSYS
    &CELL
      A     5.05630000     0.00000000     0.00000000
      B     0.00000000     5.05630000     0.00000000
      C     0.00000000     0.00000000     7.37395200
      PERIODIC XYZ #Direction(s) of applied PBC (geometry aspect)
    &END CELL
    &COORD
            COORD_FILE_NAME coord.xyz
            COORD_FILE_FORMAT XYZ
    &END COORD  
#   &VELOCITY #You can set initial atomic velocities in this section
#   &END VELOCITY
    &KIND Si
      ELEMENT Si
      BASIS_SET DZVP-MOLOPT-SR-GTH-q4
      POTENTIAL GTH-PBE
    &END KIND
  &END SUBSYS

  &DFT
    BASIS_SET_FILE_NAME  BASIS_MOLOPT
    POTENTIAL_FILE_NAME  POTENTIAL
#   WFN_RESTART_FILE_NAME Si4O8vesta-RESTART.wfn
    CHARGE    0 #Net charge
    MULTIPLICITY    1 #Spin multiplicity
    &QS
      EPS_DEFAULT 1.0E-10 #Set all EPS_xxx to values such that the energy will be correct up to this value
      EXTRAPOLATION ASPC #Extrapolation for wavefunction during e.g. MD. ASPC is default, PS can also be used
      EXTRAPOLATION_ORDER 3 #Order for PS or ASPC extrapolation. 3 is default
    &END QS
    &POISSON
      PERIODIC XYZ #Direction(s) of PBC for calculating electrostatics
      PSOLVER PERIODIC #The way to solve Poisson equation
    &END POISSON
    &XC
      &XC_FUNCTIONAL PBE
      &END XC_FUNCTIONAL
    &END XC
    &MGRID
      CUTOFF  300
      REL_CUTOFF  40
    &END MGRID
    &SCF
      MAX_SCF 128
      EPS_SCF 1.0E-05 #Convergence threshold of density matrix of inner SCF
#     SCF_GUESS RESTART #Use wavefunction from WFN_RESTART_FILE_NAME file as initial guess
      IGNORE_CONVERGENCE_FAILURE #Continue calculation even if SCF not converged, works for version >= 2024.1
      &DIAGONALIZATION
        ALGORITHM STANDARD #Algorithm for diagonalization
      &END DIAGONALIZATION
      &MIXING #How to mix old and new density matrices
        METHOD BROYDEN_MIXING #PULAY_MIXING is also a good alternative
        ALPHA 0.4 #Default. Mixing 40% of new density matrix with the old one
        NBROYDEN 8 #Default is 4. Number of previous steps stored for the actual mixing scheme
      &END MIXING
      &PRINT
        &RESTART OFF #Do not generate wfn file to suppress meaningless I/O cost
        &END RESTART
      &END PRINT
    &END SCF
  &END DFT
  # if stress tensor is not need to computed, comment out the below line.
  STRESS_TENSOR ANALYTICAL 
  &PRINT
      # if stress tensor is not need to computed, comment out the below line
      &STRESS_TENSOR ON
      # if stress tensor is not need to computed, comment out the below line
        &EACH
      # if stress tensor is not need to computed, comment out the below line
            MD 1
      # if stress tensor is not need to computed, comment out the below line
        &END EACH
      # if stress tensor is not need to computed, comment out the below line
      &END STRESS_TENSOR
  &END PRINT        
&END FORCE_EVAL

&MOTION
  &MD
    ENSEMBLE NVT
    STEPS 50 #Number of steps to run
    TIMESTEP 1.0 #Step size in fs. Decrease it properly for high temperature simulation
    TEMPERATURE 298.15 #Initial and maintained temperature (K)
#   COMVEL_TOL 0 #Uncomment this can remove translation motion of center-of-mass every step
    &THERMOSTAT
      TYPE CSVR
      &CSVR
        TIMECON 200 #Time constant in fs. Smaller/larger results in stronger/weaker temperature coupling
      &END CSVR
    &END THERMOSTAT
    &PRINT
      &PROGRAM_RUN_INFO
        &EACH
          MD     1 #Output frequency of MD information, 0 means never
        &END EACH
      &END PROGRAM_RUN_INFO
    &END PRINT
  &END MD
  &PRINT
    &TRAJECTORY
      &EACH
        MD   1 #Output frequency of coordinates, 0 means never
      &END EACH
      FORMAT xyz
    &END TRAJECTORY
    &VELOCITIES
      &EACH
        MD     0 #Output frequency of velocities, 0 means never
      &END EACH
    &END VELOCITIES
    &FORCES
      &EACH
        MD     1 #Output frequency of forces, 0 means never
      &END EACH
    &END FORCES
    &RESTART
      BACKUP_COPIES 0 #Maximum number of backing up restart file, 0 means never
      &EACH
        MD  1 #Frequency of updating last restart file, 0 means never
      &END EACH
    &END RESTART
    &RESTART_HISTORY OFF 
    &END RESTART_HISTORY
  &END PRINT
&END MOTION

